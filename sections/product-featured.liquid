{% schema %}
{
  "name": "Product Featured",
  "settings": [
    {
      "type": "text",
      "id": "section_title",
      "label": "Section Title",
      "default": "El producto"
    },
    {
      "type": "textarea",
      "id": "section_subtitle",
      "label": "Section Subtitle",
      "default": "Cada gota cuenta para la salud de tu gato"
    },
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "textarea",
      "id": "product_tagline",
      "label": "Product Tagline",
      "default": "Esencia natural que hace que el agua sea irresistible para tu gato"
    },
    {
      "type": "text",
      "id": "cta_primary_text",
      "label": "Primary CTA Text",
      "default": "Comprar ahora"
    },
    {
      "type": "text",
      "id": "cta_secondary_text",
      "label": "Secondary CTA Text",
      "default": "Ver ingredientes"
    },
    {
      "type": "text",
      "id": "guarantee_title",
      "label": "Guarantee Title",
      "default": "Garantía satisfacción"
    },
    {
      "type": "text",
      "id": "guarantee_description",
      "label": "Guarantee Description",
      "default": "30 días o te devolvemos tu dinero"
    },
    {
      "type": "text",
      "id": "badge_text",
      "label": "Featured Badge Text",
      "default": "Producto destacado"
    },
    {
      "type": "text",
      "id": "tax_text",
      "label": "Tax Text",
      "default": "IVA incluido"
    },
    {
      "type": "header",
      "content": "Espaciado Móvil (< 768px)"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "label": "Espaciado superior móvil (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 64,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "label": "Espaciado inferior móvil (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 64,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_left_mobile",
      "label": "Espaciado izquierdo móvil (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_right_mobile",
      "label": "Espaciado derecho móvil (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "content_gap_mobile",
      "label": "Separación entre elementos móvil (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 32,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Espaciado Tablet (768px - 1024px)"
    },
    {
      "type": "range",
      "id": "padding_top_tablet",
      "label": "Espaciado superior tablet (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 80,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_tablet",
      "label": "Espaciado inferior tablet (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 80,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_left_tablet",
      "label": "Espaciado izquierdo tablet (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 24,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_right_tablet",
      "label": "Espaciado derecho tablet (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 24,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "content_gap_tablet",
      "label": "Separación entre elementos tablet (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 48,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Espaciado Desktop (>= 1024px)"
    },
    {
      "type": "range",
      "id": "padding_top_desktop",
      "label": "Espaciado superior desktop (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 96,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_desktop",
      "label": "Espaciado inferior desktop (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 96,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_left_desktop",
      "label": "Espaciado izquierdo desktop (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 32,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_right_desktop",
      "label": "Espaciado derecho desktop (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 32,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "content_gap_desktop",
      "label": "Separación entre elementos desktop (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 64,
      "unit": "px"
    }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Product Feature",
      "settings": [
        {
          "type": "text",
          "id": "icon",
          "label": "Icon (Line Awesome)",
          "default": "la-leaf"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "100% Natural"
        },
        {
          "type": "text",
          "id": "description",
          "label": "Description",
          "default": "Solo ingredientes naturales"
        }
      ]
    },
    {
      "type": "trust_badge",
      "name": "Trust Badge",
      "settings": [
        {
          "type": "text",
          "id": "icon",
          "label": "Icon (Line Awesome)",
          "default": "la-shipping-fast"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Envío 24-48h"
        }
      ]
    }
  ]
}
{% endschema %}

{%- assign product = all_products[section.settings.product] -%}
{%- if product.selected_or_first_available_variant -%}
  {%- assign variant = product.selected_or_first_available_variant -%}
  {%- assign product_price = variant.price | money_without_trailing_zeros -%}
  {%- assign checkout_url = '/cart/add?id=' | append: variant.id -%}
{%- else -%}
  {%- assign product_price = '29€' -%}
  {%- assign checkout_url = '#producto' -%}
{%- endif -%}

<style>
  #product-featured-{{ section.id }} {
    padding-top: {{ section.settings.padding_top_mobile }}px;
    padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
    padding-left: {{ section.settings.padding_left_mobile }}px;
    padding-right: {{ section.settings.padding_right_mobile }}px;
  }

  #product-featured-{{ section.id }} .product-featured-container {
    gap: {{ section.settings.content_gap_mobile }}px;
  }

  @media (min-width: 768px) and (max-width: 1023px) {
    #product-featured-{{ section.id }} {
      padding-top: {{ section.settings.padding_top_tablet }}px;
      padding-bottom: {{ section.settings.padding_bottom_tablet }}px;
      padding-left: {{ section.settings.padding_left_tablet }}px;
      padding-right: {{ section.settings.padding_right_tablet }}px;
    }

    #product-featured-{{ section.id }} .product-featured-container {
      gap: {{ section.settings.content_gap_tablet }}px;
    }
  }

  @media (min-width: 1024px) {
    #product-featured-{{ section.id }} {
      padding-top: {{ section.settings.padding_top_desktop }}px;
      padding-bottom: {{ section.settings.padding_bottom_desktop }}px;
      padding-left: {{ section.settings.padding_left_desktop }}px;
      padding-right: {{ section.settings.padding_right_desktop }}px;
    }

    #product-featured-{{ section.id }} .product-featured-container {
      gap: {{ section.settings.content_gap_desktop }}px;
    }
  }
</style>

<section id="product-featured-{{ section.id }}" class="bg-white">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

    <!-- Section Header -->
    <div class="text-center mb-20 max-w-3xl mx-auto">
      <h2 class="heading-xl text-wacat-navy mb-6">
        {{ section.settings.section_title }}
      </h2>
      <p class="body-lg text-secondary">
        {{ section.settings.section_subtitle }}
      </p>
    </div>

    <!-- Main Product Layout -->
    <div class="product-featured-container grid grid-cols-1 lg:grid-cols-2 items-start mb-20">

      <!-- Product Image Column -->
      <div class="relative">
        <!-- Decorative background - simplified -->
        <div class="absolute -top-12 -right-12 w-80 h-80 bg-wacat-cream rounded-full opacity-30 blur-3xl hidden lg:block"></div>

        <div class="relative z-10">
          {% if product.featured_image %}
            <img
              src="{{ product.featured_image | img_url: 'master' }}"
              alt="{{ product.title }}"
              class="w-full h-auto rounded-3xl shadow-lg"
              loading="lazy"
            />
          {% else %}
            <div class="aspect-square bg-gradient-to-br from-wacat-cream to-white rounded-3xl shadow-lg flex items-center justify-center">
              <i class="las la-box text-9xl text-wacat-navy/20"></i>
            </div>
          {% endif %}
        </div>
      </div>

      <!-- Product Info Column -->
      <div class="space-y-10">

        <!-- Product Title & Price -->
        <div>
          <div class="mb-4">
            <span class="badge badge-primary">
              <i class="las la-star mr-1"></i>
              {{ section.settings.badge_text }}
            </span>
          </div>

          <h3 class="heading-lg text-primary mb-4">
            {{ product.title | default: 'WACAT Esencia Natural' }}
          </h3>

          <p class="body-md text-secondary mb-6">
            {{ section.settings.product_tagline }}
          </p>

          <div class="flex items-baseline gap-3 mb-8">
            <span class="text-5xl font-extralight text-wacat-navy">{{ product_price }}</span>
            <span class="caption text-tertiary">{{ section.settings.tax_text }}</span>
          </div>
        </div>

        <!-- Product Features Grid -->
        {% if section.blocks.size > 0 %}
          {% assign feature_blocks = section.blocks | where: "type", "feature" %}
          {% if feature_blocks.size > 0 %}
            <div class="grid grid-cols-2 gap-6">
              {% for block in feature_blocks %}
                <div class="flex items-start gap-3 p-4 bg-wacat-cream/30 rounded-xl">
                  <div class="icon-circle icon-circle-sm bg-white flex-shrink-0">
                    <i class="las {{ block.settings.icon }} text-lg text-wacat-navy"></i>
                  </div>
                  <div>
                    <div class="text-sm font-medium text-primary mb-1">{{ block.settings.title }}</div>
                    <div class="caption text-tertiary">{{ block.settings.description }}</div>
                  </div>
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% endif %}

        <!-- CTAs -->
        <div class="flex flex-col sm:flex-row gap-4">
          <a href="{{ checkout_url }}" class="btn btn-primary btn-xl flex-1">
            <i class="las la-shopping-cart"></i>
            {{ section.settings.cta_primary_text }}
          </a>
          <a href="#beneficios" class="btn btn-secondary btn-xl flex-1">
            {{ section.settings.cta_secondary_text }}
          </a>
        </div>

        <!-- Trust Badges -->
        {% if section.blocks.size > 0 %}
          {% assign trust_blocks = section.blocks | where: "type", "trust_badge" %}
          {% if trust_blocks.size > 0 %}
            <div class="flex flex-wrap items-center gap-6 pt-4 border-t border-wacat-navy/10">
              {% for block in trust_blocks %}
                <div class="flex items-center gap-2 text-tertiary">
                  <i class="las {{ block.settings.icon }} text-lg"></i>
                  <span class="caption">{{ block.settings.text }}</span>
                </div>
              {% endfor %}
              <!-- Guarantee integrated -->
              <div class="flex items-center gap-2 text-green-600">
                <i class="las la-check-circle text-lg"></i>
                <span class="caption">{{ section.settings.guarantee_title }}</span>
              </div>
            </div>
          {% endif %}
        {% endif %}

      </div>
    </div>

    <!-- Product Description or Additional Info -->
    {% if product.description != blank %}
      <div class="max-w-4xl mx-auto">
        <div class="card">
          <div class="prose prose-lg max-w-none">
            {{ product.description }}
          </div>
        </div>
      </div>
    {% endif %}

  </div>
</section>

{% schema %}
{
  "name": "CTA Final",
  "settings": [
    {
      "type": "textarea",
      "id": "title",
      "label": "Title",
      "default": "Dale a tu gato la hidratación que merece y necesita"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "No esperes a que aparezcan problemas de salud. Previene ahora y disfruta de más años juntos."
    },
    {
      "type": "text",
      "id": "cta_primary_text",
      "label": "Primary CTA Text",
      "default": "Sí, quiero cuidar a mi gato"
    },
    {
      "type": "text",
      "id": "cta_secondary_text",
      "label": "Secondary CTA Text",
      "default": "Ver farmacias cercanas"
    },
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "textarea",
      "id": "testimonial_quote",
      "label": "Testimonial Quote",
      "default": "Llevaba meses preocupada porque Luna apenas bebía. Con WACAT ha sido un cambio increíble. Ahora bebe 3 veces más y está mucho más activa."
    },
    {
      "type": "text",
      "id": "testimonial_author",
      "label": "Testimonial Author",
      "default": "María"
    },
    {
      "type": "text",
      "id": "testimonial_cat_name",
      "label": "Testimonial Cat Name",
      "default": "Luna"
    },
    {
      "type": "text",
      "id": "testimonial_cat_age",
      "label": "Testimonial Cat Age",
      "default": "7 años"
    }
  ]
}
{% endschema %}

{%- assign product = all_products[section.settings.product] -%}
{%- if product.selected_or_first_available_variant -%}
  {%- assign variant = product.selected_or_first_available_variant -%}
  {%- assign product_price = variant.price | money_without_trailing_zeros -%}
  {%- assign checkout_url = '/cart/add?id=' | append: variant.id -%}
{%- else -%}
  {%- assign product_price = '29€' -%}
  {%- assign checkout_url = '#producto' -%}
{%- endif -%}

<section class="relative bg-wacat-navy section-spacing overflow-hidden">
  <!-- Background pattern -->
  <div class="absolute inset-0 bg-pattern-dots opacity-10"></div>

  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">

    <!-- Main CTA Content -->
    <div class="text-center mb-16">
      <h2 class="text-4xl md:text-5xl lg:text-6xl font-extralight text-white mb-8 leading-tight">
        {{ section.settings.title }}
      </h2>

      <p class="text-xl md:text-2xl text-white/80 font-light max-w-3xl mx-auto mb-12">
        {{ section.settings.subtitle }}
      </p>

      <!-- Primary CTA -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-12">
        <a href="{{ checkout_url }}" class="btn btn-white btn-xl">
          <i class="las la-shopping-cart"></i>
          {{ section.settings.cta_primary_text }}
          {% if product_price != '' %}
            <span class="ml-2">{{ product_price }}</span>
          {% endif %}
        </a>
        <a href="#donde-comprar" class="btn btn-ghost-white btn-xl">
          {{ section.settings.cta_secondary_text }}
        </a>
      </div>

      <!-- Trust indicators -->
      <div class="flex flex-wrap justify-center items-center gap-8 text-white/70">
        <div class="flex items-center gap-2">
          <i class="las la-shield-alt text-xl"></i>
          <span class="text-sm">Garantía 30 días</span>
        </div>
        <div class="flex items-center gap-2">
          <i class="las la-shipping-fast text-xl"></i>
          <span class="text-sm">Envío 24-48h</span>
        </div>
        <div class="flex items-center gap-2">
          <i class="las la-star text-xl"></i>
          <span class="text-sm">+1000 gatos felices</span>
        </div>
      </div>
    </div>

    <!-- Optional Testimonial -->
    {% if section.settings.testimonial_quote != blank %}
      <div class="max-w-2xl mx-auto mt-20">
        <div class="bg-white/10 backdrop-blur-sm rounded-3xl p-8 md:p-10 border border-white/20">
          <div class="text-center">
            <i class="las la-quote-left text-3xl text-white/40 mb-6"></i>
            <blockquote class="text-lg md:text-xl text-white/90 font-light mb-6 leading-relaxed">
              "{{ section.settings.testimonial_quote }}"
            </blockquote>
            <div class="text-white/80">
              <p class="font-medium">{{ section.settings.testimonial_author }}</p>
              {% if section.settings.testimonial_cat_name %}
                <p class="text-sm text-white/60">
                  {{ section.settings.testimonial_cat_name }}
                  {% if section.settings.testimonial_cat_age %} · {{ section.settings.testimonial_cat_age }}{% endif %}
                </p>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    {% endif %}

  </div>
</section>

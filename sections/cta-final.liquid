{% schema %}
{
  "name": "CTA Final",
  "settings": [
    {
      "type": "textarea",
      "id": "title",
      "label": "Title",
      "default": "Dale a tu gato la hidratación que merece y necesita"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "No esperes a que aparezcan problemas de salud. Previene ahora y disfruta de más años juntos."
    },
    {
      "type": "text",
      "id": "cta_primary_text",
      "label": "Primary CTA Text",
      "default": "Sí, quiero cuidar a mi gato"
    },
    {
      "type": "text",
      "id": "cta_secondary_text",
      "label": "Secondary CTA Text",
      "default": "Ver farmacias cercanas"
    },
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "textarea",
      "id": "testimonial_quote",
      "label": "Testimonial Quote",
      "default": "Llevaba meses preocupada porque Luna apenas bebía. Con WACAT ha sido un cambio increíble. Ahora bebe 3 veces más y está mucho más activa."
    },
    {
      "type": "text",
      "id": "testimonial_author",
      "label": "Testimonial Author",
      "default": "María"
    },
    {
      "type": "text",
      "id": "testimonial_cat_name",
      "label": "Testimonial Cat Name",
      "default": "Luna"
    },
    {
      "type": "text",
      "id": "testimonial_cat_age",
      "label": "Testimonial Cat Age",
      "default": "7 años"
    },
    {
      "type": "text",
      "id": "trust_guarantee",
      "label": "Trust Indicator - Guarantee",
      "default": "Garantía 30 días"
    },
    {
      "type": "text",
      "id": "trust_shipping",
      "label": "Trust Indicator - Shipping",
      "default": "Envío 24-48h"
    },
    {
      "type": "header",
      "content": "Espaciado Móvil (< 768px)"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "label": "Espaciado superior móvil (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 64,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "label": "Espaciado inferior móvil (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 64,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_left_mobile",
      "label": "Espaciado izquierdo móvil (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_right_mobile",
      "label": "Espaciado derecho móvil (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "content_gap_mobile",
      "label": "Separación entre elementos móvil (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 32,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Espaciado Tablet (768px - 1024px)"
    },
    {
      "type": "range",
      "id": "padding_top_tablet",
      "label": "Espaciado superior tablet (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 80,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_tablet",
      "label": "Espaciado inferior tablet (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 80,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_left_tablet",
      "label": "Espaciado izquierdo tablet (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 24,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_right_tablet",
      "label": "Espaciado derecho tablet (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 24,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "content_gap_tablet",
      "label": "Separación entre elementos tablet (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 48,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Espaciado Desktop (>= 1024px)"
    },
    {
      "type": "range",
      "id": "padding_top_desktop",
      "label": "Espaciado superior desktop (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 96,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_desktop",
      "label": "Espaciado inferior desktop (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 96,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_left_desktop",
      "label": "Espaciado izquierdo desktop (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 32,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_right_desktop",
      "label": "Espaciado derecho desktop (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 32,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "content_gap_desktop",
      "label": "Separación entre elementos desktop (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 64,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Animaciones"
    },
    {
      "type": "checkbox",
      "id": "animation_enabled",
      "label": "Habilitar animaciones",
      "default": true
    },
    {
      "type": "select",
      "id": "animation_type",
      "label": "Tipo de animación",
      "default": "fadeInUp",
      "options": [
        { "value": "none", "label": "Sin animación" },
        { "value": "fadeIn", "label": "Fade In" },
        { "value": "fadeInUp", "label": "Fade In Up" },
        { "value": "fadeInDown", "label": "Fade In Down" },
        { "value": "fadeInLeft", "label": "Fade In Left" },
        { "value": "fadeInRight", "label": "Fade In Right" },
        { "value": "scaleIn", "label": "Scale In" },
        { "value": "zoomIn", "label": "Zoom In" },
        { "value": "slideInUp", "label": "Slide In Up" },
        { "value": "slideInDown", "label": "Slide In Down" },
        { "value": "slideInLeft", "label": "Slide In Left" },
        { "value": "slideInRight", "label": "Slide In Right" },
        { "value": "rotateIn", "label": "Rotate In" },
        { "value": "flipInX", "label": "Flip In X" },
        { "value": "flipInY", "label": "Flip In Y" },
        { "value": "bounceIn", "label": "Bounce In" },
        { "value": "elastic", "label": "Elastic" }
      ]
    },
    {
      "type": "range",
      "id": "animation_duration",
      "label": "Duración animación (ms)",
      "min": 200,
      "max": 2000,
      "step": 100,
      "default": 800,
      "unit": "ms"
    },
    {
      "type": "range",
      "id": "animation_delay",
      "label": "Delay animación (ms)",
      "min": 0,
      "max": 2000,
      "step": 100,
      "default": 0,
      "unit": "ms"
    },
    {
      "type": "range",
      "id": "animation_stagger",
      "label": "Stagger entre elementos (ms)",
      "min": 0,
      "max": 300,
      "step": 50,
      "default": 100,
      "unit": "ms",
      "info": "Retraso escalonado entre elementos hijos animados"
    },
    {
      "type": "checkbox",
      "id": "animation_repeat",
      "label": "Repetir animación al hacer scroll",
      "default": false
    }
  ]
}
{% endschema %}

{%- assign product = all_products[section.settings.product] -%}
{%- if product.selected_or_first_available_variant -%}
  {%- assign variant = product.selected_or_first_available_variant -%}
  {%- assign product_price = variant.price | money_without_trailing_zeros -%}
  {%- assign checkout_url = '/cart/add?id=' | append: variant.id -%}
{%- else -%}
  {%- assign product_price = '29€' -%}
  {%- assign checkout_url = '#producto' -%}
{%- endif -%}

<style>
  #cta-final-{{ section.id }} {
    padding-top: {{ section.settings.padding_top_mobile }}px;
    padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
    padding-left: {{ section.settings.padding_left_mobile }}px;
    padding-right: {{ section.settings.padding_right_mobile }}px;
  }

  #cta-final-{{ section.id }} .cta-final-container {
    gap: {{ section.settings.content_gap_mobile }}px;
  }

  @media (min-width: 768px) and (max-width: 1023px) {
    #cta-final-{{ section.id }} {
      padding-top: {{ section.settings.padding_top_tablet }}px;
      padding-bottom: {{ section.settings.padding_bottom_tablet }}px;
      padding-left: {{ section.settings.padding_left_tablet }}px;
      padding-right: {{ section.settings.padding_right_tablet }}px;
    }

    #cta-final-{{ section.id }} .cta-final-container {
      gap: {{ section.settings.content_gap_tablet }}px;
    }
  }

  @media (min-width: 1024px) {
    #cta-final-{{ section.id }} {
      padding-top: {{ section.settings.padding_top_desktop }}px;
      padding-bottom: {{ section.settings.padding_bottom_desktop }}px;
      padding-left: {{ section.settings.padding_left_desktop }}px;
      padding-right: {{ section.settings.padding_right_desktop }}px;
    }

    #cta-final-{{ section.id }} .cta-final-container {
      gap: {{ section.settings.content_gap_desktop }}px;
    }
  }
</style>

<section id="cta-final-{{ section.id }}" class="relative bg-wacat-navy overflow-hidden"
  {% if section.settings.animation_enabled %}
    data-animate="true"
    data-animation-type="{{ section.settings.animation_type }}"
    data-animation-duration="{{ section.settings.animation_duration }}"
    data-animation-delay="{{ section.settings.animation_delay }}"
    data-animation-stagger="{{ section.settings.animation_stagger }}"
    data-animation-repeat="{{ section.settings.animation_repeat }}"
  {% endif %}>
  <!-- Background pattern -->
  <div class="absolute inset-0 bg-pattern-dots opacity-10"></div>

  <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
    <div class="cta-final-container flex flex-col">

    <!-- Main CTA Content -->
    <div class="text-center">
      <h2 class="text-4xl md:text-5xl lg:text-6xl font-extralight text-white mb-8 leading-tight">
        {{ section.settings.title }}
      </h2>

      <p class="text-xl md:text-2xl text-white/80 font-light max-w-3xl mx-auto mb-12">
        {{ section.settings.subtitle }}
      </p>

      <!-- Primary CTA -->
      <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mb-12">
        <a href="{{ checkout_url }}" class="btn btn-white btn-xl">
          <i class="las la-shopping-cart"></i>
          {{ section.settings.cta_primary_text }}
          {% if product_price != '' %}
            <span class="ml-2">{{ product_price }}</span>
          {% endif %}
        </a>
        <a href="#donde-comprar" class="btn btn-ghost-white btn-xl">
          {{ section.settings.cta_secondary_text }}
        </a>
      </div>

      <!-- Trust indicators -->
      <div class="flex flex-wrap justify-center items-center gap-8 text-white/70">
        <div class="flex items-center gap-2">
          <i class="las la-shield-alt text-xl"></i>
          <span class="text-sm">{{ section.settings.trust_guarantee }}</span>
        </div>
        <div class="flex items-center gap-2">
          <i class="las la-shipping-fast text-xl"></i>
          <span class="text-sm">{{ section.settings.trust_shipping }}</span>
        </div>
      </div>
    </div>

    <!-- Optional Testimonial -->
    {% if section.settings.testimonial_quote != blank %}
      <div class="max-w-2xl mx-auto">
        <div class="bg-white/10 backdrop-blur-sm rounded-3xl p-8 md:p-10 border border-white/20">
          <div class="text-center">
            <i class="las la-quote-left text-3xl text-white/40 mb-6"></i>
            <blockquote class="text-lg md:text-xl text-white/90 font-light mb-6 leading-relaxed">
              "{{ section.settings.testimonial_quote }}"
            </blockquote>
            <div class="text-white/80">
              <p class="font-medium">{{ section.settings.testimonial_author }}</p>
              {% if section.settings.testimonial_cat_name %}
                <p class="text-sm text-white/60">
                  {{ section.settings.testimonial_cat_name }}
                  {% if section.settings.testimonial_cat_age %} · {{ section.settings.testimonial_cat_age }}{% endif %}
                </p>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    {% endif %}
    </div>

  </div>
</section>

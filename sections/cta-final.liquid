{% schema %}
{
  "name": "CTA Final",
  "settings": [
    {
      "type": "textarea",
      "id": "title",
      "label": "Title",
      "default": "Dale a tu gato la hidratación que merece y necesita"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "No esperes a que aparezcan problemas de salud. Previene ahora y disfruta de más años juntos."
    },
    {
      "type": "text",
      "id": "cta_primary_text",
      "label": "Primary CTA Text",
      "default": "Sí, quiero cuidar a mi gato"
    },
    {
      "type": "text",
      "id": "cta_secondary_text",
      "label": "Secondary CTA Text",
      "default": "Ver farmacias cercanas"
    },
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "textarea",
      "id": "testimonial_quote",
      "label": "Testimonial Quote",
      "default": "Llevaba meses preocupada porque Luna apenas bebía. Con WACAT ha sido un cambio increíble. Ahora bebe 3 veces más y está mucho más activa."
    },
    {
      "type": "text",
      "id": "testimonial_author",
      "label": "Testimonial Author",
      "default": "María"
    },
    {
      "type": "text",
      "id": "testimonial_cat_name",
      "label": "Testimonial Cat Name",
      "default": "Luna"
    },
    {
      "type": "text",
      "id": "testimonial_cat_age",
      "label": "Testimonial Cat Age",
      "default": "7 años"
    },
    {
      "type": "text",
      "id": "trust_guarantee",
      "label": "Trust Indicator - Guarantee",
      "default": "Garantía 30 días"
    },
    {
      "type": "text",
      "id": "trust_shipping",
      "label": "Trust Indicator - Shipping",
      "default": "Envío 24-48h"
    },
    {
      "type": "header",
      "content": "Espaciado Móvil (< 768px)"
    },
    {
      "type": "range",
      "id": "padding_top_mobile",
      "label": "Espaciado superior móvil (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 64,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_mobile",
      "label": "Espaciado inferior móvil (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 64,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_left_mobile",
      "label": "Espaciado izquierdo móvil (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_right_mobile",
      "label": "Espaciado derecho móvil (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 16,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "content_gap_mobile",
      "label": "Separación entre elementos móvil (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 32,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Espaciado Tablet (768px - 1024px)"
    },
    {
      "type": "range",
      "id": "padding_top_tablet",
      "label": "Espaciado superior tablet (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 80,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_tablet",
      "label": "Espaciado inferior tablet (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 80,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_left_tablet",
      "label": "Espaciado izquierdo tablet (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 24,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_right_tablet",
      "label": "Espaciado derecho tablet (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 24,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "content_gap_tablet",
      "label": "Separación entre elementos tablet (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 48,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Espaciado Desktop (>= 1024px)"
    },
    {
      "type": "range",
      "id": "padding_top_desktop",
      "label": "Espaciado superior desktop (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 96,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_bottom_desktop",
      "label": "Espaciado inferior desktop (px)",
      "min": 0,
      "max": 400,
      "step": 8,
      "default": 96,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_left_desktop",
      "label": "Espaciado izquierdo desktop (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 32,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "padding_right_desktop",
      "label": "Espaciado derecho desktop (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 32,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "content_gap_desktop",
      "label": "Separación entre elementos desktop (px)",
      "min": 0,
      "max": 200,
      "step": 4,
      "default": 64,
      "unit": "px"
    },
    {
      "type": "header",
      "content": "Animaciones"
    },
    {
      "type": "checkbox",
      "id": "animation_enabled",
      "label": "Habilitar animaciones",
      "default": true
    },
    {
      "type": "select",
      "id": "animation_type",
      "label": "Tipo de animación",
      "default": "fadeInUp",
      "options": [
        { "value": "none", "label": "Sin animación" },
        { "value": "fadeIn", "label": "Fade In" },
        { "value": "fadeInUp", "label": "Fade In Up" },
        { "value": "fadeInDown", "label": "Fade In Down" },
        { "value": "fadeInLeft", "label": "Fade In Left" },
        { "value": "fadeInRight", "label": "Fade In Right" },
        { "value": "scaleIn", "label": "Scale In" },
        { "value": "zoomIn", "label": "Zoom In" },
        { "value": "slideInUp", "label": "Slide In Up" },
        { "value": "slideInDown", "label": "Slide In Down" },
        { "value": "slideInLeft", "label": "Slide In Left" },
        { "value": "slideInRight", "label": "Slide In Right" },
        { "value": "rotateIn", "label": "Rotate In" },
        { "value": "flipInX", "label": "Flip In X" },
        { "value": "flipInY", "label": "Flip In Y" },
        { "value": "bounceIn", "label": "Bounce In" },
        { "value": "elastic", "label": "Elastic" }
      ]
    },
    {
      "type": "range",
      "id": "animation_duration",
      "label": "Duración animación (ms)",
      "min": 200,
      "max": 2000,
      "step": 100,
      "default": 800,
      "unit": "ms"
    },
    {
      "type": "range",
      "id": "animation_delay",
      "label": "Delay animación (ms)",
      "min": 0,
      "max": 2000,
      "step": 100,
      "default": 0,
      "unit": "ms"
    },
    {
      "type": "range",
      "id": "animation_stagger",
      "label": "Stagger entre elementos (ms)",
      "min": 0,
      "max": 300,
      "step": 50,
      "default": 100,
      "unit": "ms",
      "info": "Retraso escalonado entre elementos hijos animados"
    },
    {
      "type": "checkbox",
      "id": "animation_repeat",
      "label": "Repetir animación al hacer scroll",
      "default": false
    }
  ]
}
{% endschema %}

{%- assign product = all_products[section.settings.product] -%}
{%- if product.selected_or_first_available_variant -%}
  {%- assign variant = product.selected_or_first_available_variant -%}
  {%- assign product_price = variant.price | money_without_trailing_zeros -%}
  {%- assign checkout_url = '/cart/add?id=' | append: variant.id -%}
{%- else -%}
  {%- assign product_price = '29€' -%}
  {%- assign checkout_url = '#producto' -%}
{%- endif -%}

<style>
  #cta-final-{{ section.id }} {
    position: relative;
    background-color: #121212;
    overflow: hidden;
    padding-top: {{ section.settings.padding_top_mobile }}px;
    padding-bottom: {{ section.settings.padding_bottom_mobile }}px;
    padding-left: {{ section.settings.padding_left_mobile }}px;
    padding-right: {{ section.settings.padding_right_mobile }}px;
  }

  #cta-final-{{ section.id }} .cta-final-background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: 0.1;
    background-image: radial-gradient(circle, #ffffff 1px, transparent 1px);
    background-size: 20px 20px;
  }

  #cta-final-{{ section.id }} .cta-final-wrapper {
    max-width: 120rem;
    margin-left: auto;
    margin-right: auto;
    position: relative;
    z-index: 10;
  }

  #cta-final-{{ section.id }} .cta-final-container {
    display: flex;
    flex-direction: column;
    gap: {{ section.settings.content_gap_mobile }}px;
  }

  #cta-final-{{ section.id }} .cta-final-content {
    text-align: center;
  }

  #cta-final-{{ section.id }} .cta-final-title {
    font-family: Assistant, sans-serif;
    font-size: 30px !important; /* h1 mobile EXACTO B3TTER */
    font-weight: 400 !important;
    color: #ffffff;
    line-height: 1.2 !important;
    letter-spacing: 0.06rem !important; /* EXACTO B3TTER */
    margin-top: 0;
    margin-bottom: 32px;
  }

  #cta-final-{{ section.id }} .cta-final-subtitle {
    font-family: Assistant, sans-serif;
    font-size: 20px !important; /* h2 mobile EXACTO B3TTER */
    font-weight: 400 !important;
    color: rgba(255, 255, 255, 0.8);
    line-height: 1.4 !important;
    letter-spacing: 0.06rem !important; /* EXACTO B3TTER */
    max-width: 48rem;
    margin-left: auto;
    margin-right: auto;
    margin-top: 0;
    margin-bottom: 48px;
  }

  #cta-final-{{ section.id }} .cta-final-buttons {
    display: flex;
    flex-direction: column;
    gap: 16px;
    justify-content: center;
    align-items: center;
    margin-bottom: 48px;
  }

  #cta-final-{{ section.id }} .cta-final-button-primary {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 21px 27px;
    font-family: Assistant, sans-serif;
    font-size: 16px !important; /* body text EXACTO B3TTER */
    font-weight: 400 !important;
    letter-spacing: 0.06rem !important; /* EXACTO B3TTER */
    background-color: #ffffff;
    color: #121212;
    border: 2px solid #ffffff;
    border-radius: 32px;
    text-decoration: none;
    transition: all 0.3s ease;
    cursor: pointer;
  }

  #cta-final-{{ section.id }} .cta-final-button-primary:hover {
    background-color: #F3F3F3;
    border-color: #F3F3F3;
  }

  #cta-final-{{ section.id }} .cta-final-button-secondary {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 21px 27px;
    font-family: Assistant, sans-serif;
    font-size: 16px !important; /* body text EXACTO B3TTER */
    font-weight: 400 !important;
    letter-spacing: 0.06rem !important; /* EXACTO B3TTER */
    background-color: transparent;
    color: #ffffff;
    border: 2px solid #ffffff;
    border-radius: 32px;
    text-decoration: none;
    transition: all 0.3s ease;
    cursor: pointer;
  }

  #cta-final-{{ section.id }} .cta-final-button-secondary:hover {
    background-color: rgba(255, 255, 255, 0.1);
  }

  #cta-final-{{ section.id }} .cta-final-button-icon {
    font-size: 20px !important;
  }

  #cta-final-{{ section.id }} .cta-final-button-price {
    margin-left: 8px;
  }

  #cta-final-{{ section.id }} .cta-final-trust {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    gap: 32px;
    color: rgba(255, 255, 255, 0.7);
  }

  #cta-final-{{ section.id }} .cta-final-trust-item {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  #cta-final-{{ section.id }} .cta-final-trust-icon {
    font-size: 20px !important;
  }

  #cta-final-{{ section.id }} .cta-final-trust-text {
    font-family: Assistant, sans-serif;
    font-size: 14px !important;
    font-weight: 400 !important;
  }

  #cta-final-{{ section.id }} .cta-final-testimonial-wrapper {
    max-width: 42rem;
    margin-left: auto;
    margin-right: auto;
  }

  #cta-final-{{ section.id }} .cta-final-testimonial {
    background-color: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding: 32px;
    border: 1px solid rgba(255, 255, 255, 0.2);
  }

  #cta-final-{{ section.id }} .cta-final-testimonial-inner {
    text-align: center;
  }

  #cta-final-{{ section.id }} .cta-final-testimonial-quote-icon {
    font-size: 48px !important;
    color: rgba(255, 255, 255, 0.4);
    margin-bottom: 24px;
  }

  #cta-final-{{ section.id }} .cta-final-testimonial-quote {
    font-family: Assistant, sans-serif;
    font-size: 16px !important; /* body text EXACTO B3TTER */
    font-weight: 400 !important;
    color: rgba(255, 255, 255, 0.9);
    line-height: 1.6 !important;
    letter-spacing: 0.06rem !important; /* EXACTO B3TTER */
    margin: 0 0 24px 0;
    font-style: italic;
  }

  #cta-final-{{ section.id }} .cta-final-testimonial-author-wrapper {
    color: rgba(255, 255, 255, 0.8);
  }

  #cta-final-{{ section.id }} .cta-final-testimonial-author {
    font-family: Assistant, sans-serif;
    font-size: 16px !important;
    font-weight: 400 !important;
    margin: 0 0 4px 0;
  }

  #cta-final-{{ section.id }} .cta-final-testimonial-meta {
    font-family: Assistant, sans-serif;
    font-size: 14px !important;
    font-weight: 400 !important;
    color: rgba(255, 255, 255, 0.6);
    margin: 0;
  }

  @media (min-width: 768px) {
    #cta-final-{{ section.id }} {
      padding-top: {{ section.settings.padding_top_tablet }}px;
      padding-bottom: {{ section.settings.padding_bottom_tablet }}px;
      padding-left: {{ section.settings.padding_left_tablet }}px;
      padding-right: {{ section.settings.padding_right_tablet }}px;
    }

    #cta-final-{{ section.id }} .cta-final-container {
      gap: {{ section.settings.content_gap_tablet }}px;
    }

    #cta-final-{{ section.id }} .cta-final-title {
      font-size: 40px !important; /* h1 desktop EXACTO B3TTER */
    }

    #cta-final-{{ section.id }} .cta-final-subtitle {
      font-size: 24px !important; /* h2 desktop EXACTO B3TTER */
    }

    #cta-final-{{ section.id }} .cta-final-buttons {
      flex-direction: row;
    }

    #cta-final-{{ section.id }} .cta-final-button-primary,
    #cta-final-{{ section.id }} .cta-final-button-secondary {
      padding: 28px 36px;
    }

    #cta-final-{{ section.id }} .cta-final-testimonial {
      padding: 40px;
    }

    #cta-final-{{ section.id }} .cta-final-testimonial-quote {
      font-size: 16px !important; /* body text B3TTER (sin cambio desktop) */
    }
  }

  @media (min-width: 1024px) {
    #cta-final-{{ section.id }} {
      padding-top: {{ section.settings.padding_top_desktop }}px;
      padding-bottom: {{ section.settings.padding_bottom_desktop }}px;
      padding-left: {{ section.settings.padding_left_desktop }}px;
      padding-right: {{ section.settings.padding_right_desktop }}px;
    }

    #cta-final-{{ section.id }} .cta-final-container {
      gap: {{ section.settings.content_gap_desktop }}px;
    }

    #cta-final-{{ section.id }} .cta-final-title {
      font-size: 40px !important; /* h1 desktop EXACTO B3TTER (no 60px) */
    }

    #cta-final-{{ section.id }} .cta-final-subtitle {
      font-size: 24px !important; /* h2 desktop EXACTO B3TTER */
    }

    #cta-final-{{ section.id }} .cta-final-button-primary,
    #cta-final-{{ section.id }} .cta-final-button-secondary {
      padding: 36px 48px;
      font-size: 16px !important; /* body text EXACTO B3TTER (no 20px) */
    }
  }
</style>

<section id="cta-final-{{ section.id }}"
  {% if section.settings.animation_enabled %}
    data-animate="true"
    data-animation-type="{{ section.settings.animation_type }}"
    data-animation-duration="{{ section.settings.animation_duration }}"
    data-animation-delay="{{ section.settings.animation_delay }}"
    data-animation-stagger="{{ section.settings.animation_stagger }}"
    data-animation-repeat="{{ section.settings.animation_repeat }}"
  {% endif %}>

  <div class="cta-final-background"></div>

  <div class="cta-final-wrapper">
    <div class="cta-final-container">

      <div class="cta-final-content">
        <h2 class="cta-final-title">
          {{ section.settings.title }}
        </h2>

        <p class="cta-final-subtitle">
          {{ section.settings.subtitle }}
        </p>

        <div class="cta-final-buttons">
          <a href="{{ checkout_url }}" class="cta-final-button-primary">
            <i class="las la-shopping-cart cta-final-button-icon"></i>
            {{ section.settings.cta_primary_text }}
            {% if product_price != '' %}
              <span class="cta-final-button-price">{{ product_price }}</span>
            {% endif %}
          </a>
          <a href="#donde-comprar" class="cta-final-button-secondary">
            {{ section.settings.cta_secondary_text }}
          </a>
        </div>

        <div class="cta-final-trust">
          <div class="cta-final-trust-item">
            <i class="las la-shield-alt cta-final-trust-icon"></i>
            <span class="cta-final-trust-text">{{ section.settings.trust_guarantee }}</span>
          </div>
          <div class="cta-final-trust-item">
            <i class="las la-shipping-fast cta-final-trust-icon"></i>
            <span class="cta-final-trust-text">{{ section.settings.trust_shipping }}</span>
          </div>
        </div>
      </div>

      {% if section.settings.testimonial_quote != blank %}
        <div class="cta-final-testimonial-wrapper">
          <div class="cta-final-testimonial">
            <div class="cta-final-testimonial-inner">
              <i class="las la-quote-left cta-final-testimonial-quote-icon"></i>
              <blockquote class="cta-final-testimonial-quote">
                "{{ section.settings.testimonial_quote }}"
              </blockquote>
              <div class="cta-final-testimonial-author-wrapper">
                <p class="cta-final-testimonial-author">{{ section.settings.testimonial_author }}</p>
                {% if section.settings.testimonial_cat_name %}
                  <p class="cta-final-testimonial-meta">
                    {{ section.settings.testimonial_cat_name }}
                    {% if section.settings.testimonial_cat_age %} · {{ section.settings.testimonial_cat_age }}{% endif %}
                  </p>
                {% endif %}
              </div>
            </div>
          </div>
        </div>
      {% endif %}
    </div>

  </div>
</section>
